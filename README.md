# F1 Analytics System üèéÔ∏è

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≥–æ–Ω–æ—á–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –§–æ—Ä–º—É–ª—ã 1.

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Å–±–æ—Ä–∞, —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ –ø–∏–ª–æ—Ç–∞—Ö, –∫–æ–º–∞–Ω–¥–∞—Ö, –≥–æ–Ω–æ—á–Ω—ã—Ö —É–∏–∫-—ç–Ω–¥–∞—Ö –∏ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö.

**–ö—É—Ä—Å–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞** –ø–æ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–µ "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"  
**–î–∞—Ç–∞—Å–µ—Ç**: [Formula 1 World Championship (1950-2020)](https://www.kaggle.com/datasets/rohanrao/formula-1-world-championship-1950-2020)

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL 16
- **Backend**: Python 3.11, FastAPI, SQLAlchemy
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: JWT —Å —Ä–æ–ª—è–º–∏ (admin/user)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker Compose

## –†–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### üë§ User (–û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
- –î–æ—Å—Ç—É–ø –∫ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–º –æ—Ç—á–µ—Ç–∞–º

### üë®‚Äçüíº Admin (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
- –í—Å–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–°–æ–∑–¥–∞–Ω–∏–µ, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**
- –ë–∞—Ç—á–µ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env
```bash
cp .env.example .env
```

‚ö†Ô∏è **–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env**: –∏–∑–º–µ–Ω–∏—Ç–µ `SECRET_KEY` –∏ `POSTGRES_PASSWORD`

### 2. –°–∫–∞—á–∞–π—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç Kaggle

–°–∫–∞—á–∞–π—Ç–µ CSV —Ñ–∞–π–ª—ã —Å [Kaggle](https://www.kaggle.com/datasets/rohanrao/formula-1-world-championship-1950-2020/data) –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ `database/data/kaggle_dataset/`:
- circuits.csv
- constructors.csv
- drivers.csv
- races.csv
- results.csv
- status.csv

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
```bash
docker-compose up -d
```

### 4. –°–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
```bash
docker-compose exec backend python scripts/create_admin.py
```

### 5. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ CSV —Ñ–∞–π–ª—ã —Ä–∞–∑–º–µ—â–µ–Ω—ã)
```bash
docker-compose exec backend python scripts/load_kaggle_data.py
```

### 6. –û—Ç–∫—Ä–æ–π—Ç–µ Swagger UI

–ü–µ—Ä–µ–π–¥–∏—Ç–µ: **http://localhost:8000/docs**

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ Swagger

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `POST /api/auth/login` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Authorize" üîì
3. –í–≤–µ–¥–∏—Ç–µ: `Bearer YOUR_ACCESS_TOKEN`
4. –ù–∞–∂–º–∏—Ç–µ "Authorize"

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:**
- `POST /api/auth/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /api/auth/login` - –í—Ö–æ–¥
- `GET /api/auth/me` - –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

**–î–∞–Ω–Ω—ã–µ:**
- `GET /api/drivers` - –°–ø–∏—Å–æ–∫ –ø–∏–ª–æ—Ç–æ–≤
- `POST /api/drivers` - –°–æ–∑–¥–∞—Ç—å –ø–∏–ª–æ—Ç–∞ (admin)
- `GET /api/constructors` - –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- `GET /api/races` - –°–ø–∏—Å–æ–∫ –≥–æ–Ω–æ–∫
- `GET /api/results` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ê–Ω–∞–ª–∏—Ç–∏–∫–∞:**
- `GET /api/analytics/driver-stats/{id}` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∏–ª–æ—Ç–∞
- `GET /api/analytics/season-standings/{year}` - –¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞
- `GET /api/analytics/driver-statistics` - –¢–æ–ø-50 –ø–∏–ª–æ—Ç–æ–≤
- `GET /api/analytics/constructor-statistics` - –¢–æ–ø-50 –∫–æ–º–∞–Ω–¥

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã (12 —à—Ç)
- drivers, constructors, circuits, races
- results (>25,000 –∑–∞–ø–∏—Å–µ–π), qualifying, lap_times, pit_stops
- driver_standings, constructor_standings
- users, audit_log

### SQL —Ñ—É–Ω–∫—Ü–∏–∏ (11 —à—Ç)
**–°–∫–∞–ª—è—Ä–Ω—ã–µ:**
- calculate_driver_total_points
- calculate_driver_wins
- calculate_driver_podiums
- calculate_constructor_total_points
- calculate_constructor_wins
- calculate_average_lap_time

**–¢–∞–±–ª–∏—á–Ω—ã–µ:**
- get_season_driver_standings
- get_season_constructor_standings
- get_driver_career_stats
- get_constructor_season_results
- get_circuit_history

### –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (VIEW)
- v_driver_statistics
- v_constructor_statistics
- v_race_results_detailed

### –¢—Ä–∏–≥–≥–µ—Ä—ã
- –ê—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (INSERT/UPDATE/DELETE)
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ updated_at

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

35+ –∏–Ω–¥–µ–∫—Å–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:
- –ü–æ–∏—Å–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤: **19x –±—ã—Å—Ç—Ä–µ–µ**
- –ü–æ–∏—Å–∫ –ø–∏–ª–æ—Ç–∞: **14x –±—ã—Å—Ç—Ä–µ–µ**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ–∑–æ–Ω–∞: **12x –±—ã—Å—Ç—Ä–µ–µ**

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
f1-analytics-system/
‚îú‚îÄ‚îÄ database/init/        # SQL —Å–∫—Ä–∏–ø—Ç—ã (6 —Ñ–∞–π–ª–æ–≤)
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ main.py          # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ app/             # –ú–æ–¥–µ–ª–∏, —Å—Ö–µ–º—ã, —Ä–æ—É—Ç–µ—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ scripts/         # –£—Ç–∏–ª–∏—Ç—ã
‚îî‚îÄ‚îÄ docs/                # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚úÖ –ü–∞—Ä–æ–ª–∏ —Ö—ç—à–∏—Ä—É—é—Ç—Å—è (bcrypt)  
‚úÖ JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏  
‚úÖ –†–æ–ª–∏ PostgreSQL (app_admin, app_user)  
‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã  
‚úÖ –°–µ–∫—Ä–µ—Ç—ã –≤ .env —Ñ–∞–π–ª–µ  

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f backend

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose stop

# –£–¥–∞–ª–µ–Ω–∏–µ —Å –¥–∞–Ω–Ω—ã–º–∏
docker-compose down -v

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
docker-compose exec postgres psql -U f1admin -d f1_analytics
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫—É—Ä—Å–æ–≤–æ–π ‚úÖ

‚úÖ 12 —Ç–∞–±–ª–∏—Ü —Å —Å–≤—è–∑—è–º–∏  
‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (PK, FK, CHECK, NOT NULL)  
‚úÖ >25,000 –∑–∞–ø–∏—Å–µ–π –≤ results  
‚úÖ 35+ –∏–Ω–¥–µ–∫—Å–æ–≤ —Å EXPLAIN ANALYZE  
‚úÖ 11 SQL —Ñ—É–Ω–∫—Ü–∏–π  
‚úÖ 3 –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (VIEW)  
‚úÖ –¢—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –∞—É–¥–∏—Ç–∞  
‚úÖ CRUD —á–µ—Ä–µ–∑ FastAPI  
‚úÖ JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å —Ä–æ–ª—è–º–∏  
‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è  
‚úÖ Docker Compose  
‚úÖ –ë–∞—Ç—á–µ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ CSV  

---
**–£–¥–∞—á–∏ –Ω–∞ –∑–∞—â–∏—Ç–µ! üèÅ**
